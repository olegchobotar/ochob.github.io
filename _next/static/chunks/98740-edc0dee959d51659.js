"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[44050,98740],{44050:(e,t,n)=>{n.r(t),n.d(t,{decimals:()=>s,isDecimalsSupported:()=>r.Vo});var o=n(71679),r=n(2106);async function s(e){return(0,o.n)(()=>(0,r.rr)(e),{cacheKey:`${e.contract.chain.id}:${e.contract.address}:decimals`,cacheTime:Number.POSITIVE_INFINITY})}},98740:(e,t,n)=>{n.r(t),n.d(t,{default:()=>e9});var o=n(95155),r=n(35906),s=n(12115),i=n(92223),a=n(75231);function c(e){let t=e.toToken.chainId===e.onRampToken.token.chainId,n=(0,a.bv)(e.toToken.tokenAddress)===(0,a.bv)(e.onRampToken.token.tokenAddress);return!(t&&n)}var l=n(56883),d=n(29524),u=n(21050),h=n(93233),x=n(10438),m=n(25007),p=n(94271),y=n(40492);async function f(e){try{let t=(0,m.KI)(e.client),n=await t((0,y._5)(),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:(0,p.A)({toAddress:e.toAddress,fromCurrencySymbol:e.fromCurrencySymbol,toChainId:e.toChainId.toString(),toTokenAddress:e.toTokenAddress,fromAmount:e.fromAmount,toAmount:e.toAmount,maxSlippageBPS:e.maxSlippageBPS,isTestMode:e.isTestMode,purchaseData:e.purchaseData,fromAddress:e.fromAddress,toGasAmountWei:e.toGasAmountWei,preferredProvider:e.preferredProvider})});if(!n.ok){let e=await n.json();if(e&&"error"in e)throw e;throw Error(`HTTP error! status: ${n.status}`)}return(await n.json()).result}catch(e){throw console.error("Error getting buy with fiat quote",e),e}}var j=n(97727),g=n(8390),C=n(9424),b=n(59789),k=n(7062),w=n(21685),T=n(63344),S=n(44925),A=n(90482),v=n(14138),W=n(78749),B=n(95111),z=n(74583),R=n(97307),E=n(75462),I=n(32235),D=n(87215),F=n(54003),O=n(89288),L=n(32068),M=n(44050),K=n(52204),q=n(7853),P=n(77643),N=n(69729),_=n(27534),$=n(18788),H=n(30727),Y=n(96004),U=n(62978);function G(e){let{payUiOptions:t,supportedDestinations:n,client:r,onContinue:s,payerAccount:c}=e,u=(0,q.useCustomTheme)(),x=(0,N.useActiveWallet)(),m=t.metadata,p=t.paymentInfo,{data:y}=(0,P.cj)(p.chain),{data:f}=(0,_.vq)({client:r,address:p.sellerAddress}),j=(0,h.useQuery)({queryKey:["amount",p],queryFn:async()=>{let e=18;return p.token&&!(0,F.r)(p.token)&&(e=await (0,M.decimals)({contract:(0,L.getContract)({address:p.token.address,chain:p.chain,client:r})})),"amountWei"in p?(0,K.ow)(p.amountWei,e):p.amount}}).data;if(!y||void 0===j)return(0,o.jsx)(b.x,{});let g=p.token?{...p.token,icon:p.token?.icon||n.find(e=>e.chain.id===p.chain.id)?.tokens.find(e=>e.address.toLowerCase()===p.token?.address.toLowerCase())?.icon}:{address:i.DG,name:y.nativeCurrency.name,symbol:y.nativeCurrency.symbol,icon:y.icon?.url};return(0,o.jsxs)(v.Container,{p:"lg",children:[(0,o.jsx)(v.ModalHeader,{title:m?.name||"Payment Details"}),(0,o.jsx)(T.h,{y:"lg"}),(0,o.jsxs)(v.Container,{children:[m?.image?(0,o.jsx)(H.Img,{client:r,src:m?.image,style:{width:"100%",borderRadius:d.YK.md,backgroundColor:u.colors.tertiaryBg}}):x?(0,o.jsxs)(v.Container,{flex:"row",center:"both",style:{padding:d.YK.md,marginBottom:d.YK.md,borderRadius:d.YK.md,backgroundColor:u.colors.tertiaryBg},children:[(0,o.jsx)(U.WalletImage,{size:d.RK.xl,id:x.id,client:r}),(0,o.jsx)("div",{style:{flexGrow:1,borderBottom:"6px dotted",borderColor:u.colors.secondaryIconColor,marginLeft:d.YK.md,marginRight:d.YK.md}}),(0,o.jsx)($.P,{client:r,size:d.RK.xl,chainIconUrl:y.icon?.url})]}):null,(0,o.jsx)(T.h,{y:"md"}),(0,o.jsxs)(v.Container,{flex:"row",children:[(0,o.jsx)(v.Container,{flex:"column",expand:!0,children:(0,o.jsx)(B.Text,{size:"md",color:"primaryText",weight:700,children:"Price"})}),(0,o.jsx)(v.Container,{expand:!0,children:(0,o.jsxs)(v.Container,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,o.jsx)(Y.TokenIcon,{chain:p.chain,client:e.client,size:"sm",token:g}),(0,o.jsxs)(B.Text,{color:"primaryText",size:"md",weight:700,children:[String((0,l.Z)(Number(j),6))," ",g.symbol]})]})})]}),(0,o.jsx)(T.h,{y:"md"}),(0,o.jsx)(v.Line,{}),(0,o.jsx)(T.h,{y:"md"}),(0,o.jsxs)(v.Container,{flex:"row",children:[(0,o.jsx)(v.Container,{flex:"column",expand:!0,children:(0,o.jsx)(B.Text,{size:"xs",color:"secondaryText",children:"Network"})}),(0,o.jsx)(v.Container,{expand:!0,children:(0,o.jsxs)(v.Container,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,o.jsx)($.P,{chainIconUrl:y.icon?.url,size:"xs",client:e.client}),(0,o.jsx)(B.Text,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:y.name})]})})]}),(0,o.jsx)(T.h,{y:"sm"}),(0,o.jsxs)(v.Container,{flex:"row",children:[(0,o.jsx)(v.Container,{flex:"column",expand:!0,children:(0,o.jsx)(B.Text,{size:"xs",color:"secondaryText",children:"Seller"})}),(0,o.jsx)(v.Container,{expand:!0,children:(0,o.jsx)(v.Container,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:(0,o.jsx)(B.Text,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:f||(0,a.Wr)(p.sellerAddress)})})})]})]}),(0,o.jsx)(T.h,{y:"xl"}),c?(0,o.jsx)(W.Button,{variant:"accent",fullWidth:!0,onClick:()=>{(0,O.G)({event:"choose_payment_method_direct_payment_mode",client:r,walletAddress:c.address,walletType:x?.id}),s(j,p.chain,g)},children:"Choose Payment Method"}):(0,o.jsx)("div",{children:(0,o.jsx)(R.ConnectButton,{...e.connectOptions,client:r,theme:u,connectButton:{style:{width:"100%"}}})})]})}var V=n(87365),Q=n(42839),Z=n(98032);function J(e){let{estimatedSeconds:t,quoteIsLoading:n}=e;return(0,o.jsxs)(v.Container,{bg:"tertiaryBg",flex:"row",borderColor:"borderColor",style:{borderRadius:d.r8.md,borderTopLeftRadius:0,borderTopRightRadius:0,justifyContent:"space-between",alignItems:"center",borderWidth:"1px",borderStyle:"solid"},children:[(0,o.jsxs)(v.Container,{flex:"row",center:"y",gap:"xxs",color:"accentText",p:"sm",children:[(0,o.jsx)(V.O4,{width:d.RK.sm,height:d.RK.sm}),n?(0,o.jsx)(Q.Skeleton,{height:d.J.xs,width:"50px",color:"borderColor"}):(0,o.jsx)(B.Text,{size:"xs",color:"secondaryText",children:void 0!==t?`~${(0,Z.X)(t)}`:"--"})]}),(0,o.jsxs)(W.Button,{variant:"ghost",onClick:e.onViewFees,gap:"xs",children:[(0,o.jsx)(v.Container,{color:"accentText",flex:"row",center:"both",children:(0,o.jsx)(X,{size:d.RK.sm})}),(0,o.jsx)(B.Text,{size:"xs",color:"secondaryText",children:"View Fees"})]})]})}let X=e=>(0,o.jsxs)("svg",{width:e.size,height:e.size,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M9.5 1.5H2.5C1.94772 1.5 1.5 1.94772 1.5 2.5V9.5C1.5 10.0523 1.94772 10.5 2.5 10.5H9.5C10.0523 10.5 10.5 10.0523 10.5 9.5V2.5C10.5 1.94772 10.0523 1.5 9.5 1.5Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M4.5 7.5L7.5 4.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]});var ee=n(31086),et=n(30411);function en(e){return(0,o.jsxs)(v.Container,{bg:"tertiaryBg",borderColor:"borderColor",flex:"row",style:{borderRadius:d.r8.md,borderBottomRightRadius:0,borderBottomLeftRadius:0,borderWidth:"1px",borderStyle:"solid",borderBottom:"none",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)(eo,{variant:"ghost",onClick:e.onSelectCurrency,style:{minHeight:"64px",justifyContent:"flex-start",minWidth:"50%"},gap:"sm",children:[(0,o.jsx)(e.currency.icon,{size:d.RK.md}),(0,o.jsxs)(v.Container,{flex:"row",center:"y",gap:"xxs",color:"secondaryText",children:[(0,o.jsx)(B.Text,{color:"primaryText",children:e.currency.shorthand}),(0,o.jsx)(V.D3D,{width:d.RK.sm,height:d.RK.sm})]})]}),(0,o.jsx)("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:d.YK.xxs,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",justifyContent:"center",paddingRight:d.YK.sm},children:e.isLoading?(0,o.jsx)(Q.Skeleton,{width:"100px",height:d.J.lg}):(0,o.jsx)(B.Text,{size:"lg",color:e.value?"primaryText":"secondaryText",children:e.value?`${(0,l.Z)(Number(e.value),6)}`:"--"})})]})}let eo=(0,et.A)(W.Button)(()=>({"&[disabled]:hover":{borderColor:"transparent"}}));var er=n(23193),es=n(82744);function ei(e){let t=(0,q.useCustomTheme)(),[n,r]=(0,s.useState)(!1),i=n?e.balances:e.balances.slice(0,3);return(0,o.jsxs)(v.Container,{bg:"tertiaryBg",style:{borderRadius:d.r8.lg,border:`1px solid ${t.colors.borderColor}`},children:[(0,o.jsx)(v.Container,{style:{padding:d.YK.sm},children:(0,o.jsx)(ec,{...e})}),(0,o.jsx)("div",{style:{borderTop:`1px solid ${t.colors.borderColor}`}}),(0,o.jsx)(v.Container,{flex:"column",children:e.balances.length>0?(0,o.jsxs)(o.Fragment,{children:[i.map(t=>(0,o.jsx)(ea,{client:e.client,onClick:()=>e.onClick(e.wallet,t.token,t.chain),tokenBalance:t,wallet:e.wallet},`${t.token.address}-${t.chain.id}`)),e.balances.length>3&&(0,o.jsx)(el,{variant:"secondary",onClick:()=>r(!n),style:{justifyContent:"start"},children:(0,o.jsx)(B.Text,{size:"xs",children:n?"Show less":"Show more"})})]}):(0,o.jsx)(v.Container,{style:{padding:d.YK.sm},children:(0,o.jsx)(B.Text,{size:"sm",color:"secondaryText",children:"Not enough funds"})})})]})}function ea(e){let{tokenBalance:t,wallet:n,onClick:r,client:s}=e,i=(0,P.Kj)(t.chain);return(0,o.jsxs)(el,{onClick:()=>r(t.token,n),variant:"secondary",children:[(0,o.jsx)(Y.TokenIcon,{token:t.token,chain:t.chain,size:"md",client:s}),(0,o.jsxs)(v.Container,{flex:"column",gap:"3xs",children:[(0,o.jsx)(B.Text,{size:"xs",color:"primaryText",children:t.token.symbol}),i&&(0,o.jsx)(B.Text,{size:"xs",children:i.name})]}),(0,o.jsx)("div",{style:{flex:1}}),(0,o.jsx)(v.Container,{flex:"row",center:"y",gap:"3xs",children:(0,o.jsx)(B.Text,{size:"xs",color:"secondaryText",children:(0,er.j)(t.balance,!0)})})]})}function ec(e){let{client:t,address:n}=e,r=e.walletId,s=(0,q.useCustomTheme)(),i=(0,_.vq)({client:t,address:n}),c=i.data||(0,a.Wr)(n),l=(0,_.$$)({client:t,ensName:i.data});return(0,o.jsxs)(v.Container,{flex:"row",center:"y",gap:"sm",color:"secondaryText",children:[l.data?(0,o.jsx)(H.Img,{src:l.data,width:e.iconSize?d.RK[e.iconSize]:d.RK.md,height:e.iconSize?d.RK[e.iconSize]:d.RK.md,style:{borderRadius:"100%",overflow:"hidden",border:`1px solid ${s.colors.borderColor}`},client:e.client}):r?(0,o.jsx)(U.WalletImage,{id:r,size:e.iconSize||d.RK.md,client:e.client}):(0,o.jsx)(v.Container,{style:{width:d.RK.md,height:d.RK.md,borderRadius:"100%",overflow:"hidden",border:`1px solid ${s.colors.borderColor}`},children:(0,o.jsx)(es.Blobbie,{address:e.address,size:Number(d.RK.md)})}),(0,o.jsx)(B.Text,{size:e.textSize||"sm",color:"primaryText",children:c||(0,a.Wr)(e.address)})]})}let el=(0,et.A)(W.Button)(e=>{let t=(0,q.useCustomTheme)();return{background:t.colors.tertiaryBg,justifyContent:"flex-start",flexDirection:"row",padding:d.YK.sm,gap:d.YK.sm,"&:hover":{background:t.colors.secondaryButtonBg,transform:"scale(1.01)"},transition:"background 200ms ease, transform 150ms ease"}});var ed=n(62251),eu=n(37188),eh=n(50856),ex=n(98399),em=n(36431),ep=n(75309);function ey(e){let{payUiOptions:t,client:n,payerAccount:r,supportedDestinations:a,onContinue:c}=e,{data:x,error:m,isLoading:p,refetch:y}=(0,P.cj)(t.transaction.chain),f=t.metadata,{data:g,error:k,isLoading:w,refetch:S}=function(e){let{transaction:t,account:n,supportedDestinations:o}=e,[r,a]=(0,s.useState)();return(0,s.useEffect)(()=>{Promise.all([(0,em.r)(t.value),(0,em.r)(t.erc20Value),(0,em.r)(t.to),(0,eh.encode)(t)]).then(([e,t,n,o])=>{a({value:e?.toString(),erc20Value:t?.amountWei?.toString(),erc20Currency:t?.tokenAddress,to:n,data:o})})},[t]),(0,h.useQuery)({queryKey:["transaction-cost",t.chain.id,n?.address,r],queryFn:async()=>{if(!n)throw Error("No payer account found");let e=await (0,em.r)(t.erc20Value);if(e){let[r,s,i]=await Promise.all([(0,ep.m)({address:n.address,chain:t.chain,client:t.client,tokenAddress:e.tokenAddress}),(0,eu.getCurrencyMetadata)({contract:(0,L.getContract)({address:e.tokenAddress,chain:t.chain,client:t.client})}),(0,ex.D)(t,n?.address)]),a=e.amountWei;return{token:{address:e.tokenAddress,name:s.name,symbol:s.symbol,icon:o.find(e=>e.chain.id===t.chain.id)?.tokens.find(t=>t.address.toLowerCase()===e.tokenAddress.toLowerCase())?.icon},decimals:s.decimals,walletBalance:r,gasCostWei:i,transactionValueWei:a}}let[r,s,a]=await Promise.all([(0,ep.m)({address:n.address,chain:t.chain,client:t.client}),(0,ed.getChainMetadata)(t.chain),(0,ex.D)(t,n?.address)]),c=await (0,em.r)(t.value)||0n;return{token:{address:i.DG,name:s.nativeCurrency.name,symbol:s.nativeCurrency.symbol,icon:s.icon?.url},decimals:18,walletBalance:r,gasCostWei:a,transactionValueWei:c}},enabled:!!t&&!!r,refetchInterval:()=>{if(!t.erc20Value)return 3e4}})}({transaction:t.transaction,account:r,supportedDestinations:a}),A=(0,q.useCustomTheme)(),E=(0,N.useActiveWallet)(),I=(0,j.useActiveAccount)(),D=(0,_.UH)(E),M=(0,u.X)({address:I?.address,chain:t.transaction.chain,tokenAddress:(0,F.r)(g?.token||F.g)?void 0:g?.token.address,client:e.client},{enabled:!!g});if(w||p)return(0,o.jsx)(b.x,{});if(k||m)return(0,o.jsx)(v.Container,{style:{minHeight:"350px"},fullHeight:!0,flex:"row",center:"both",children:(0,o.jsx)(C.W,{title:k?.message||m?.message||"Something went wrong",onTryAgain:k?S:y})});if(!g||!x)return(0,o.jsx)(b.x,{});let U=M.data&&M.data.value<g.transactionValueWei;return(0,o.jsxs)(v.Container,{p:"lg",children:[(0,o.jsx)(v.ModalHeader,{title:f?.name||"Transaction"}),(0,o.jsx)(T.h,{y:"lg"}),(0,o.jsxs)(v.Container,{children:[f?.image?(0,o.jsx)(H.Img,{client:n,src:f?.image,style:{width:"100%",borderRadius:d.YK.md,border:`1px solid ${A.colors.borderColor}`,backgroundColor:A.colors.tertiaryBg}}):I?(0,o.jsxs)(v.Container,{flex:"column",gap:"sm",children:[U&&(0,o.jsx)(B.Text,{size:"sm",color:"danger",style:{textAlign:"center"},children:"Insufficient funds"}),(0,o.jsxs)(v.Container,{flex:"row",style:{justifyContent:"space-between",padding:d.YK.sm,marginBottom:d.YK.sm,borderRadius:d.YK.md,backgroundColor:A.colors.tertiaryBg,border:`1px solid ${A.colors.borderColor}`},children:[(0,o.jsx)(ec,{address:I?.address,iconSize:"md",client:n}),M.data?(0,o.jsxs)(v.Container,{flex:"row",gap:"3xs",center:"y",children:[(0,o.jsx)(B.Text,{size:"xs",color:"secondaryText",weight:500,children:(0,er.j)(M.data,!1)}),(0,o.jsx)(z.TokenSymbol,{token:g.token,chain:t.transaction.chain,size:"xs",color:"secondaryText"})]}):(0,o.jsx)(Q.Skeleton,{width:"70px",height:d.J.xs})]})]}):null,(0,o.jsx)(T.h,{y:"md"}),(0,o.jsxs)(v.Container,{flex:"row",children:[(0,o.jsx)(v.Container,{flex:"column",expand:!0,children:(0,o.jsx)(B.Text,{size:"md",color:"primaryText",weight:700,children:"Price"})}),(0,o.jsx)(v.Container,{expand:!0,children:(0,o.jsxs)(v.Container,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,o.jsx)(Y.TokenIcon,{chain:t.transaction.chain,client:e.client,size:"sm",token:g.token}),(0,o.jsxs)(B.Text,{color:"primaryText",size:"md",weight:700,children:[String((0,l.Z)(Number((0,K.ow)(g.transactionValueWei,g.decimals)),6))," ",g.token.symbol]})]})})]}),(0,o.jsx)(T.h,{y:"md"}),(0,o.jsx)(v.Line,{}),(0,o.jsx)(T.h,{y:"md"}),(0,o.jsxs)(v.Container,{flex:"row",children:[(0,o.jsx)(v.Container,{flex:"column",expand:!0,children:(0,o.jsx)(B.Text,{size:"xs",color:"secondaryText",children:"Gas Fees"})}),(0,o.jsx)(v.Container,{expand:!0,children:(0,o.jsx)(v.Container,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:(0,o.jsx)(B.Text,{color:D?"success":"primaryText",size:"xs",children:D?"Sponsored":`${String((0,l.Z)(Number((0,K.ow)(g.gasCostWei,x.nativeCurrency.decimals)),6))} ${x.nativeCurrency.symbol}`})})})]}),(0,o.jsx)(T.h,{y:"sm"}),(0,o.jsxs)(v.Container,{flex:"row",children:[(0,o.jsx)(v.Container,{flex:"column",expand:!0,children:(0,o.jsx)(B.Text,{size:"xs",color:"secondaryText",children:"Network"})}),(0,o.jsx)(v.Container,{expand:!0,children:(0,o.jsxs)(v.Container,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,o.jsx)($.P,{chainIconUrl:x.icon?.url,size:"xs",client:e.client}),(0,o.jsx)(B.Text,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:x.name})]})})]})]}),(0,o.jsx)(T.h,{y:"xl"}),r?(0,o.jsx)(W.Button,{variant:"accent",fullWidth:!0,onClick:()=>{let e=g.transactionValueWei;g.token.address!==i.DG||D||(e+=g.gasCostWei),(0,O.G)({event:"choose_payment_method_transaction_mode",client:n,walletAddress:r.address,walletType:E?.id}),c((0,K.ow)(e,g.decimals),t.transaction.chain,g.token)},children:"Choose Payment Method"}):(0,o.jsx)("div",{children:(0,o.jsx)(R.ConnectButton,{...e.connectOptions,client:n,theme:A,connectButton:{style:{width:"100%"}}})})]})}var ef=n(66709);function ej(e){return(0,o.jsxs)(v.Container,{children:[(0,o.jsx)(v.Container,{p:"lg",children:(0,o.jsx)(v.ModalHeader,{title:"Pay with",onBack:e.onBack})}),(0,o.jsx)(v.Line,{}),(0,o.jsx)(T.h,{y:"lg"}),(0,o.jsx)(v.Container,{flex:"column",gap:"xs",px:"lg",children:ef.qx.map(t=>(0,o.jsxs)(eg,{fullWidth:!0,variant:"secondary",onClick:()=>e.onSelect(t),gap:"sm",children:[(0,o.jsx)(t.icon,{size:d.RK.lg}),(0,o.jsxs)(v.Container,{flex:"column",gap:"xxs",children:[(0,o.jsx)(B.Text,{color:"primaryText",children:t.shorthand}),(0,o.jsx)(B.Text,{size:"sm",children:t.name})]})]},t.shorthand))}),(0,o.jsx)(T.h,{y:"lg"})]})}let eg=(0,et.A)(W.Button)(()=>{let e=(0,q.useCustomTheme)();return{background:e.colors.tertiaryBg,justifyContent:"flex-start",gap:d.YK.sm,padding:d.YK.sm,"&:hover":{background:e.colors.secondaryButtonBg,transform:"scale(1.01)"},transition:"background 200ms ease, transform 150ms ease"}});var eC=n(63825);function eb(e,t){let n=(window.innerHeight-750)/2,o=(window.innerWidth-500)/2;return window.open(`${e}&theme=${t}`,"thirdweb Pay",`width=500, height=750, top=${n}, left=${o}`)}var ek=n(57500),ew=n(54900),eT=n(94908),eS=n(52411),eA=n(89999),ev=n(46790),eW=n(94983);function eB(e){let t=(0,r.useQueryClient)(),{openedWindow:n,onSuccess:i}=e,a=(0,eT.a)({intentId:e.intentId,client:e.client}),c="loading";a.data?.status==="ON_RAMP_TRANSFER_FAILED"||a.data?.status==="PAYMENT_FAILED"?c="failed":a.data?.status==="CRYPTO_SWAP_FALLBACK"?c="partialSuccess":a.data?.status==="ON_RAMP_TRANSFER_COMPLETED"&&(c="completed");let l=(0,s.useRef)(!1);(0,s.useEffect)(()=>{!l.current&&i&&a.data?.status==="ON_RAMP_TRANSFER_COMPLETED"&&(l.current=!0,i(a.data))},[i,a.data]),(0,s.useEffect)(()=>{n&&a.data&&(a.data?.status==="CRYPTO_SWAP_REQUIRED"||a.data?.status==="ON_RAMP_TRANSFER_COMPLETED")&&n.close()},[a.data,n]);let d=(0,s.useRef)(!1);return(0,s.useEffect)(()=>{d.current||a.data?.status!=="ON_RAMP_TRANSFER_COMPLETED"||(d.current=!0,(0,g.V)(t))},[a.data,t]),(0,s.useEffect)(()=>{a.data?.status==="CRYPTO_SWAP_REQUIRED"&&e.onShowSwapFlow(a.data)},[a.data,e.onShowSwapFlow]),(0,o.jsxs)(v.Container,{p:"lg",children:[(0,o.jsx)(v.ModalHeader,{title:e.title,onBack:e.onBack}),e.hasTwoSteps&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(T.h,{y:"lg"}),(0,o.jsx)(eS.g,{steps:2,currentStep:1}),(0,o.jsx)(T.h,{y:"sm"}),(0,o.jsxs)(B.Text,{size:"xs",children:["Step 1 of 2 - Buying ",e.quote.onRampToken.token.symbol," with"," ",e.quote.fromCurrencyWithFees.currencySymbol]})]}),(0,o.jsx)(ez,{uiStatus:c,onDone:e.onDone,fiatStatus:a.data,client:e.client,transactionMode:e.transactionMode,quote:e.quote,isEmbed:e.isEmbed})]})}function ez(e){let{uiStatus:t}=e,n=e.fiatStatus?(0,ev.A)(e.fiatStatus):void 0,r=e.fiatStatus&&"NOT_FOUND"!==e.fiatStatus.status?e.fiatStatus:void 0,s=e.quote.onRampToken,i=(0,o.jsx)(eW.i,{client:e.client,token:r?.source?{chainId:r.source.token.chainId,address:r.source.token.tokenAddress,symbol:r.source.token.symbol||"",amount:r.source.amount}:{chainId:s.token.chainId,address:s.token.tokenAddress,symbol:s.token.symbol,amount:s.amount},fiat:{amount:e.quote.fromCurrencyWithFees.amount,currencySymbol:e.quote.fromCurrencyWithFees.currencySymbol},statusMeta:r?.source&&n?{color:n?.color,text:n?.status,txHash:r.source.transactionHash}:void 0});return(0,o.jsxs)(v.Container,{children:[(0,o.jsx)(T.h,{y:"xl"}),"loading"===t&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(T.h,{y:"md"}),(0,o.jsx)(v.Container,{flex:"row",center:"x",children:(0,o.jsx)(S.Spinner,{size:"xxl",color:"accentText"})}),(0,o.jsx)(T.h,{y:"md"}),(0,o.jsx)(B.Text,{color:"primaryText",size:"lg",center:!0,children:"Buy Pending"}),(0,o.jsx)(T.h,{y:"sm"}),!(0,ew.Fr)()&&(0,o.jsx)(B.Text,{center:!0,children:"Complete the purchase in popup"}),(0,o.jsx)(T.h,{y:"xxl"}),i]}),"failed"===t&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(T.h,{y:"md"}),(0,o.jsx)(v.Container,{flex:"row",center:"x",children:(0,o.jsx)(eA.g,{size:d.RK["3xl"]})}),(0,o.jsx)(T.h,{y:"lg"}),(0,o.jsx)(B.Text,{color:"primaryText",size:"lg",center:!0,children:"Transaction Failed"}),(0,o.jsx)(T.h,{y:"xxl"}),i]}),"completed"===t&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(T.h,{y:"md"}),(0,o.jsx)(v.Container,{flex:"row",center:"x",color:"success",children:(0,o.jsx)(V.KaV,{width:d.RK["3xl"],height:d.RK["3xl"]})}),(0,o.jsx)(T.h,{y:"md"}),(0,o.jsx)(B.Text,{color:"primaryText",size:"lg",center:!0,children:"Buy Complete"}),e.fiatStatus&&"NOT_FOUND"!==e.fiatStatus.status&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(T.h,{y:"xxl"}),i,(0,o.jsx)(T.h,{y:"sm"})]}),!e.isEmbed&&(0,o.jsx)(W.Button,{variant:"accent",fullWidth:!0,onClick:e.onDone,children:e.transactionMode?"Continue Transaction":"Done"})]})]})}var eR=n(81636),eE=n(79832);function eI(e){let t=c(e.quote),[n,r]=(0,s.useState)(t?{id:"step-1"}:{id:"onramp-status"}),[i,a]=(0,s.useState)(e.openedWindow),l=(0,s.useCallback)(()=>{(0,eC.H)({intentId:e.quote.intentId,client:e.client}).then(t=>{e.onSuccess(t)})},[e.onSuccess,e.quote.intentId,e.client]);return"step-1"===n.id?(0,o.jsx)(eR.Y,{title:e.title,client:e.client,onBack:e.onBack,partialQuote:(0,eR.z)(e.quote),step:1,onContinue:()=>{let t=eb(e.quote.onRampLink,e.theme);(0,O.G)({event:"open_onramp_popup",client:e.client,walletAddress:e.payer.account.address,walletType:e.payer.wallet.id}),(0,ek.b)({type:"fiat",intentId:e.quote.intentId}),a(t),r({id:"onramp-status"})}}):"onramp-status"===n.id?(0,o.jsx)(eB,{title:e.title,client:e.client,intentId:e.quote.intentId,onBack:e.onBack,hasTwoSteps:t,openedWindow:i,quote:e.quote,onDone:e.onDone,onShowSwapFlow:e=>{r({id:"postonramp-swap",data:e})},transactionMode:e.transactionMode,isEmbed:e.isEmbed,onSuccess:e.onSuccess}):"postonramp-swap"===n.id?(0,o.jsx)(eE.n,{title:e.title,status:n.data,quote:(0,eR.z)(e.quote),client:e.client,onBack:e.onBack,onDone:e.onDone,onSwapFlowStarted:()=>{},transactionMode:e.transactionMode,isEmbed:e.isEmbed,payer:e.payer,onSuccess:l}):null}let eD=(0,ed.xH)({id:137,name:"Polygon",nativeCurrency:{name:"POL",symbol:"POL",decimals:18},blockExplorers:[{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.polygonscan.com/api"}]});var eF=n(74814),eO=n(92287),eL=n(9147);function eM(e){var t;let n;let{name:r}=(0,P.Kj)(e.chain);return(0,o.jsxs)(v.Container,{children:[(0,o.jsx)("div",{onClick:e=>{e.currentTarget.querySelector("input")?.focus()},children:(0,o.jsxs)(v.Container,{flex:"row",center:"both",gap:"xs",style:{flexWrap:"nowrap"},children:[(0,o.jsx)(eL.Input,{variant:"outline",pattern:"^[0-9]*[.,]?[0-9]*$",inputMode:"decimal",tabIndex:-1,placeholder:"0",type:"text","data-placeholder":""===e.value,value:e.value||"0",disabled:e.freezeAmount,onClick:t=>{""===e.value&&t.currentTarget.setSelectionRange(t.currentTarget.value.length,t.currentTarget.value.length)},onChange:t=>{let n=t.target.value;n.startsWith(".")&&(n=`0${n}`),Number.isNaN(Number(n))||(n.startsWith("0")&&!n.startsWith("0.")?e.onChange(n.slice(1)):e.onChange(n))},style:{border:"none",fontSize:(t=e.value).length>10?"26px":t.length>6?"34px":"50px",boxShadow:"none",borderRadius:"0",padding:"0",paddingBlock:"2px",fontWeight:600,textAlign:"right",width:(n=e.value.replace(".","").length,e.value.includes(".")&&(n+=.3),`calc(${Math.max(1,n)}ch + 6px)`),maxWidth:"calc(100% - 100px)"}}),(0,o.jsx)(z.TokenSymbol,{token:e.token,chain:e.chain,size:"lg",color:"secondaryText"})]})}),!e.hideTokenSelector&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(T.h,{y:"sm"}),(0,o.jsx)(v.Container,{flex:"row",center:"x",children:(0,o.jsxs)(eK,{variant:"secondary",fullWidth:!0,style:{fontSize:d.J.sm},gap:"xxs",onClick:e.onSelectToken,disabled:e.freezeChainAndToken,children:[(0,o.jsxs)(v.Container,{flex:"row",center:"y",gap:"sm",children:[(0,o.jsx)(Y.TokenIcon,{token:e.token,chain:e.chain,size:"md",client:e.client}),(0,o.jsxs)(v.Container,{flex:"column",style:{gap:"4px"},children:[(0,o.jsx)(z.TokenSymbol,{token:e.token,chain:e.chain,size:"sm"}),r?(0,o.jsx)(B.Text,{size:"xs",color:"secondaryText",children:r}):(0,o.jsx)(Q.Skeleton,{width:"90px",height:d.J.xs})]})]}),(0,o.jsx)(V.D3D,{width:d.RK.sm,height:d.RK.sm,style:{marginLeft:"auto"}})]})})]})]})}let eK=(0,et.A)(W.Button)(()=>{let e=(0,q.useCustomTheme)();return{background:e.colors.tertiaryBg,border:`1px solid ${e.colors.borderColor}`,justifyContent:"flex-start",transition:"background 0.3s",padding:d.YK.sm}});function eq(e){return(0,o.jsx)(v.Container,{flex:"column",gap:"xs",style:{alignItems:"flex-start"},children:e.quote.processingFees.map(e=>{let t=(0,l.Z)(Number(e.amount),6);return(0,o.jsxs)(v.Container,{flex:"row",gap:"xxs",children:[(0,o.jsxs)(B.Text,{color:"primaryText",size:"sm",children:[0===t?"~":"",t," ",e.token.symbol]}),(0,o.jsxs)(B.Text,{color:"secondaryText",size:"sm",children:["($",(e.amountUSDCents/100).toFixed(2),")"]})]},`${e.token.chainId}_${e.token.tokenAddress}_${t}`)})})}function eP(e){return(0,o.jsxs)(v.Container,{flex:"column",gap:"xs",children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,o.jsx)(B.Text,{inline:!0,color:"secondaryText",children:"Amount"}),(0,o.jsxs)(B.Text,{color:"primaryText",inline:!0,children:[(0,l.Z)(Number(e.quote.fromCurrency.amount),2)," ",e.quote.fromCurrency.currencySymbol]})]}),e.quote.processingFees.map((e,t)=>{let n=(0,l.Z)(Number(e.amount),6);return(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,o.jsx)(B.Text,{inline:!0,color:"secondaryText",children:"NETWORK"===e.feeType?"Network Fee":"Processing Fee"}),(0,o.jsxs)(B.Text,{color:"primaryText",inline:!0,children:[0===n?"~":""," ",n," ",e.currencySymbol]})]},t)}),(0,o.jsx)(T.h,{y:"xxs"}),(0,o.jsx)(v.Line,{}),(0,o.jsx)(T.h,{y:"xxs"}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,o.jsx)(B.Text,{inline:!0,color:"secondaryText",children:"Total"}),(0,o.jsxs)(B.Text,{color:"primaryText",inline:!0,children:[(0,l.Z)(Number(e.quote.fromCurrencyWithFees.amount),6)," ",e.quote.fromCurrencyWithFees.currencySymbol]})]})]})}function eN(e){let t=(0,q.useCustomTheme)(),{name:n}=(0,P.Kj)(e.chain),r=(0,u.X)({address:e.payerAccount.address,chain:e.chain,tokenAddress:(0,F.r)(e.token)?void 0:e.token.address,client:e.client});return(0,o.jsxs)(v.Container,{bg:"tertiaryBg",style:{borderRadius:d.r8.lg,border:`1px solid ${t.colors.borderColor}`,...e.swapRequired?{borderBottom:"none",borderBottomLeftRadius:0,borderBottomRightRadius:0}:{}},children:[(0,o.jsxs)(v.Container,{flex:"row",gap:"sm",style:{justifyContent:"space-between",padding:d.YK.sm,borderBottom:`1px solid ${t.colors.borderColor}`},children:[(0,o.jsx)(ec,{client:e.client,address:e.payerAccount.address}),r.data?(0,o.jsxs)(v.Container,{flex:"row",gap:"3xs",center:"y",children:[(0,o.jsx)(B.Text,{size:"xs",color:"secondaryText",weight:500,children:(0,er.j)(r.data,!1)}),(0,o.jsx)(z.TokenSymbol,{token:e.token,chain:e.chain,size:"xs",color:"secondaryText"})]}):(0,o.jsx)(Q.Skeleton,{width:"70px",height:d.J.xs})]}),(0,o.jsxs)(v.Container,{flex:"row",gap:"sm",style:{paddingInline:d.YK.sm,paddingBlock:d.YK.sm,minWidth:"50%",justifyContent:"flex-start",minHeight:"64px"},children:[(0,o.jsx)(ee.f,{token:e.token,chain:e.chain,size:"md",client:e.client}),(0,o.jsxs)(v.Container,{flex:"column",gap:"3xs",children:[e.isLoading?(0,o.jsx)(Q.Skeleton,{width:"120px",height:d.J.md,color:"borderColor"}):(0,o.jsxs)(v.Container,{flex:"row",gap:"xxs",center:"y",color:"primaryText",children:[(0,o.jsx)(B.Text,{size:"md",color:e.value?"primaryText":"secondaryText",children:(0,l.Z)(Number(e.value),6)||""}),(0,o.jsx)(z.TokenSymbol,{token:e.token,chain:e.chain,size:"sm"})]}),n?(0,o.jsx)(B.Text,{size:"xs",children:n}):(0,o.jsx)(Q.Skeleton,{width:"90px",height:d.J.xs})]})]})]})}var e_=n(33025),e$=n(80142);function eH(e){let t=(0,q.useCustomTheme)(),n=(0,e_.useConnectedWallets)(),r=!e.showAllWallets&&e.wallets?.every(e=>n.includes(e)),s=(0,P.cj)(e.toChain),a=(0,j.useActiveAccount)(),c=(0,h.useQuery)({queryKey:["wallets-and-balances",n.map(e=>e.getAccount()?.address),e.sourceSupportedTokens,e.toChain.id,e.toToken,e.tokenAmount,e.mode,a?.address],queryFn:async()=>{let t=new Map,o=n.flatMap(n=>{let o=n.getAccount();if(!o)return[];t.set(n,[]);let r=(0,F.r)(e.toToken)?{address:i.DG,name:s.data?.nativeCurrency.name||"",symbol:s.data?.nativeCurrency.symbol||"",icon:s.data?.icon?.url}:e.toToken;return Object.entries({...e.sourceSupportedTokens,[e.toChain.id]:[r,...e.sourceSupportedTokens?.[e.toChain.id]||[]]}).flatMap(([s,i])=>i.map(async i=>{try{let c=(0,ed.Q4)(Number(s)),l=await (0,ep.m)({address:o.address,chain:c,tokenAddress:(0,F.r)(i)?void 0:i.address,client:e.client});if(i.address===r.address&&c.id===e.toChain.id?("fund_wallet"!==e.mode||o.address!==a?.address)&&Number(l.displayValue)>Number(e.tokenAmount):l.value>0n){let o=t.get(n)||[];o.push({balance:l,chain:c,token:i}),o.sort((t,n)=>t.chain.id===e.toChain.id&&t.token.address===r.address?-1:n.chain.id===e.toChain.id&&n.token.address===r.address?1:t.chain.id===e.toChain.id?-1:n.chain.id===e.toChain.id?1:t.chain.id>n.chain.id?1:-1)}}catch(e){console.error(`Failed to fetch balance for wallet ${n.id} on chain ${s} for token ${i.symbol}:`,e)}}))});return await Promise.all(o),t},enabled:!!e.sourceSupportedTokens&&!!s.data});return c.isLoading||!c.data?(0,o.jsx)(b.x,{}):(0,o.jsxs)(v.Container,{children:[(0,o.jsxs)(v.Container,{flex:"column",gap:"xs",children:[Array.from(c.data?.entries()||[]).filter(([t])=>!e.hiddenWallets?.includes(t.id)).map(([t,n])=>{let r=t.getAccount()?.address;return r?(0,o.jsx)(ei,{wallet:t,balances:n,client:e.client,address:r,onClick:e.onSelect},t.id):null}),!r&&(0,o.jsx)(W.Button,{variant:"secondary",fullWidth:!0,onClick:e.onConnect,gap:"xs",bg:"tertiaryBg",style:{borderRadius:d.r8.lg,border:`1px solid ${t.colors.borderColor}`,padding:d.YK.sm},children:(0,o.jsxs)(v.Container,{flex:"row",gap:"sm",center:"y",expand:!0,color:"secondaryIconColor",children:[(0,o.jsx)(e$.l,{size:d.RK.md}),(0,o.jsx)(B.Text,{size:"sm",color:"primaryText",children:"Pay with another wallet"})]})}),e.payWithFiatEnabled&&(0,o.jsx)(W.Button,{variant:"secondary",fullWidth:!0,gap:"xs",bg:"tertiaryBg",onClick:e.onSelectFiat,style:{borderRadius:d.r8.lg,border:`1px solid ${t.colors.borderColor}`,padding:d.YK.sm},children:(0,o.jsxs)(v.Container,{flex:"row",gap:"sm",center:"y",expand:!0,color:"secondaryIconColor",children:[(0,o.jsx)(V.HyM,{style:{width:d.RK.md,height:d.RK.md}}),(0,o.jsx)(B.Text,{size:"sm",color:"primaryText",children:"Pay with credit card"})]})})]}),(0,o.jsx)(T.h,{y:"sm"})]})}var eY=n(75919),eU=n(49057),eG=n(78285),eV=n(7622);async function eQ(e){try{let t=(0,m.KI)(e.client),n=await t((0,y.gy)(),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:(0,p.A)({fromAddress:e.fromAddress,toAddress:e.toAddress,chainId:e.chainId,tokenAddress:e.tokenAddress,amount:e.amount,purchaseData:e.purchaseData})});if(!n.ok){let e=await n.json();if(e&&"error"in e)throw e;throw Error(`HTTP error! status: ${n.status}`)}let o=(await n.json()).result;return{transactionRequest:{chain:(0,ed.Q4)(o.transactionRequest.chainId),client:e.client,data:o.transactionRequest.data,to:o.transactionRequest.to,value:BigInt(o.transactionRequest.value),gas:BigInt(o.transactionRequest.gasLimit)},approval:o.approval?(0,eV.S)({contract:(0,L.getContract)({client:e.client,address:o.approval.tokenAddress,chain:(0,ed.Q4)(o.approval.chainId)}),spender:o.approval.spenderAddress,amountWei:BigInt(o.approval.amountWei)}):void 0,fromAddress:o.fromAddress,toAddress:o.toAddress,paymentToken:o.paymentToken,processingFee:o.processingFee,estimatedGasCostUSDCents:o.estimatedGasCostUSDCents,client:e.client}}catch(e){throw console.error("Error getting buy with crypto transfer",e),e}}var eZ=n(90616),eJ=n(27165),eX=n(18176),e0=n(87153),e1=n(68598),e5=n(3373);function e2(e){let{title:t,onBack:n,receiverAddress:r,client:a,payer:c,onDone:l,chain:u,token:h,tokenAmount:x,transactionMode:m,setTransactionHash:p,payOptions:y}=e,[f,j]=(0,s.useState)("transfer"),[g,C]=(0,s.useState)({id:"idle"}),{symbol:b}=(0,P.ps)(u);return(0,o.jsxs)(v.Container,{p:"lg",children:[(0,o.jsx)(v.ModalHeader,{title:t,onBack:n}),(0,o.jsx)(T.h,{y:"xl"}),m&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eS.g,{steps:2,currentStep:"transfer"===f?1:2}),(0,o.jsx)(T.h,{y:"sm"}),(0,o.jsx)(B.Text,{size:"sm",children:"transfer"===f?"Step 1 of 2 - Transfer funds":"Step 2 of 2 - Finalize transaction"}),(0,o.jsx)(T.h,{y:"xl"})]}),(0,o.jsxs)(v.Container,{flex:"row",center:"y",style:{justifyContent:"space-between"},children:[(0,o.jsx)(B.Text,{size:"sm",children:"From"}),(0,o.jsx)(ec,{address:c.account.address,client:a})]}),(0,o.jsx)(T.h,{y:"md"}),(0,o.jsx)(v.Line,{}),(0,o.jsx)(T.h,{y:"md"}),(0,o.jsxs)(v.Container,{flex:"row",center:"y",style:{justifyContent:"space-between"},children:[(0,o.jsx)(B.Text,{size:"sm",children:"To"}),(0,o.jsx)(ec,{address:r,client:a})]}),(0,o.jsx)(T.h,{y:"md"}),(0,o.jsx)(v.Line,{}),(0,o.jsx)(T.h,{y:"md"}),(0,o.jsx)(e1.k,{chainId:u.id,client:a,label:"Amount",tokenAmount:x,tokenSymbol:(0,F.r)(h)?b||"":h.symbol,tokenAddress:(0,F.r)(h)?i.DG:h.address}),(0,o.jsx)(T.h,{y:"lg"}),m&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(T.h,{y:"sm"}),(0,o.jsxs)(v.Container,{gap:"sm",flex:"row",style:{justifyContent:"space-between"},center:"y",color:"accentText",children:[(0,o.jsx)(e0.p,{isDone:"execute"===f,isActive:"transfer"===f,label:"transfer"===f?"Transfer":"Done"}),(0,o.jsx)(e5.w,{}),(0,o.jsx)(e0.p,{isDone:!1,label:"Finalize",isActive:"execute"===f})]}),(0,o.jsx)(T.h,{y:"lg"})]}),"error"===g.id&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(v.Container,{flex:"row",gap:"xs",center:"both",color:"danger",children:(0,o.jsx)(B.Text,{color:"danger",size:"sm",style:{textAlign:"center"},children:"transfer"===f?`${g.error||"Failed to Transfer"}`:"Failed to Execute"})}),(0,o.jsx)(T.h,{y:"md"})]}),!m&&"execute"===f&&"done"===g.id&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(v.Container,{flex:"row",gap:"xs",center:"both",color:"success",children:[(0,o.jsx)(V.KaV,{width:d.RK.sm,height:d.RK.sm}),(0,o.jsx)(B.Text,{color:"success",size:"sm",children:"Payment completed"})]}),(0,o.jsx)(T.h,{y:"md"})]}),c.chain.id!==u.id?(0,o.jsx)(A.b,{fullWidth:!0,variant:"accent",switchChain:async()=>{await e.payer.wallet.switchChain(u)}}):(0,o.jsxs)(W.Button,{variant:"accent",fullWidth:!0,disabled:"pending"===g.id,onClick:async()=>{if("execute"===f){l();return}try{if(C({id:"pending"}),m){let t=(0,F.r)(h)?(0,eX.prepareTransaction)({client:a,chain:u,to:r,value:(0,K.fq)(x)}):(0,eG.k)({contract:(0,L.getContract)({address:h.address,chain:u,client:a}),to:r,amount:x});await (0,eZ.E)({account:e.payer.account,transaction:t}),j("execute"),C({id:"idle"})}else{let t=await eQ({client:a,fromAddress:c.account.address,toAddress:r,chainId:u.id,tokenAddress:(0,F.r)(h)?i.DG:h.address,amount:x,purchaseData:y?.purchaseData});t.approval&&(j("approve"),await (0,eZ.E)({account:e.payer.account,transaction:t.approval})),j("transfer");let n=t.transactionRequest,o=await (0,eJ.sendTransaction)({account:e.payer.account,transaction:n});p(o.transactionHash),C({id:"idle"})}}catch(e){console.error(e),C({id:"error",error:"error"in e?e.error?.message:e?.message})}},gap:"xs",children:["execute"===f&&("done"===g.id?"Done":"Continue"),"transfer"===f&&("pending"===g.id?"Confirming":"Confirm"),"approve"===f&&("pending"===g.id?"Approving":"Approve"),"pending"===g.id&&(0,o.jsx)(S.Spinner,{size:"sm",color:"accentButtonText"})]})]})}function e3(e){let[t,n]=(0,s.useState)();return t?(0,o.jsx)(eU.S,{title:e.title,onBack:e.onBack,onTryAgain:e.onTryAgain,swapTxHash:t,client:e.client,onDone:e.onDone,transactionMode:!1,isEmbed:e.isEmbed,quote:void 0,onSuccess:e.onSuccess}):(0,o.jsx)(e2,{...e,setTransactionHash:n})}var e7=n(41620);function e9(e){let t=e.payOptions.buyWithCrypto?e.payOptions.buyWithCrypto.testMode:void 0,n=(0,e7.Xw)(e.client,t);return n.isError?(0,o.jsx)(v.Container,{style:{minHeight:"350px"},fullHeight:!0,flex:"row",center:"both",children:(0,o.jsx)(C.W,{title:"Something went wrong",onTryAgain:n.refetch})}):n.data?(0,o.jsx)(e4,{...e,supportedDestinations:n.data}):(0,o.jsx)(b.x,{})}function e4(e){let{client:t,supportedDestinations:n,connectLocale:a,payOptions:c}=e,l=(0,j.useActiveAccount)(),{payer:d,setPayer:u}=function(){let e=(0,N.useActiveWallet)(),t=(0,j.useActiveAccount)(),n=(0,eF.useActiveWalletChain)(),[o,r]=(0,s.useState)();return(0,s.useEffect)(()=>{let e=o?.wallet;function t(){if(!e){r(void 0);return}let t=e.getAccount(),n=e.getChain();t&&n?r({account:t,chain:n,wallet:e}):r(void 0)}if(e){let n=e.subscribe("chainChanged",t),o=e.subscribe("accountChanged",t);return()=>{n(),o()}}},[o]),{payer:o||(t&&n&&e?{account:t,chain:n,wallet:e}:void 0),setPayer:r}}(),[h,x]=(0,s.useState)({id:"main"}),{tokenAmount:m,setTokenAmount:p,toChain:y,setToChain:f,deferredTokenAmount:C,toToken:b,setToToken:k}=function(e){let{payOptions:t,supportedDestinations:n}=e,o=t?.prefillBuy,r=(0,eF.useActiveWalletChain)(),i=o?.amount||"",[a,c]=(0,s.useState)(i),l=(0,eO.o)(a,300),[d,u]=(0,s.useState)(o?.chain||"transaction"===t.mode&&t.transaction?.chain||"direct_payment"===t.mode&&t.paymentInfo?.chain||n.find(e=>e.chain.id===r?.id)?.chain||n[0]?.chain||eD),[h,x]=(0,s.useState)(o?.token||"direct_payment"===t.mode&&t.paymentInfo.token||F.g);return{toChain:d,setToChain:u,toToken:h,setToToken:x,tokenAmount:a,setTokenAmount:c,deferredTokenAmount:l}}({payOptions:c,supportedDestinations:n}),[w,T]=(0,s.useState)(!1),S=(0,s.useCallback)(()=>{x({id:"main"}),e.onDone()},[e.onDone]),A=(0,e7.mC)({client:e.client,destinationChainId:y.id,destinationTokenAddress:(0,F.r)(b)?i.DG:b.address}),W=(0,s.useMemo)(()=>to(n,c,e.supportedTokens),[e.supportedTokens,n,c]),B=(0,s.useMemo)(()=>{if(A.data)return to(A.data,c,e.supportedTokens)},[e.supportedTokens,A.data,c]),{fromChain:z,setFromChain:R,fromToken:E,setFromToken:O}=function(e){let{payOptions:t,supportedSources:n}=e,o=n?.length?n[0]:void 0,[r,i]=(0,s.useState)(),a=!1!==t.buyWithCrypto&&t.buyWithCrypto?.prefillSource?.chain||"transaction"===t.mode&&t.transaction?.chain||"direct_payment"===t.mode&&t.paymentInfo?.chain,c=o?.chain?o.chain:void 0,l=r||a||c||eD,[d,u]=(0,s.useState)(),h=!1!==t.buyWithCrypto&&t.buyWithCrypto?.prefillSource?.token||"direct_payment"===t.mode&&t.paymentInfo.token,x=F.g;return{fromChain:l,setFromChain:i,fromToken:d||h||x||F.g,setFromToken:u}}({payOptions:c,supportedSources:A.data||[]}),{selectedCurrency:L,setSelectedCurrency:M}=function(e){let{payOptions:t}=e,n=(!1!==t.buyWithFiat?t.buyWithFiat?.prefillSource?.currency:void 0)||function(){try{let e=Intl.DateTimeFormat().resolvedOptions().timeZone.toLowerCase();if(e.includes("london"))return"GBP";if(e.includes("europe"))return"EUR";if(e.includes("japan"))return"JPY";if(e.includes("canada"))return"CAD";return"USD"}catch{return"USD"}}(),[o,r]=(0,s.useState)(ef.qx.find(e=>e.shorthand===n)||ef.a2);return{selectedCurrency:o,setSelectedCurrency:r}}({payOptions:c}),K=function(e){let{payOptions:t,supportedDestinations:n,toChain:o,toToken:r}=e,{fiat:s,swap:a}=function(){let e=n.find(e=>e.chain.id===o.id);if(!e)return{fiat:!1,swap:!1};let t=(0,F.r)(r)?i.DG:r.address,s=e.tokens.find(e=>e.address.toLowerCase()===t.toLowerCase());return s?{fiat:s.buyWithFiatEnabled,swap:s.buyWithCryptoEnabled}:{fiat:!0,swap:!0}}();return{buyWithFiatEnabled:!1!==t.buyWithFiat&&s,buyWithCryptoEnabled:!1!==t.buyWithCrypto&&a}}({payOptions:e.payOptions,supportedDestinations:e.supportedDestinations,toChain:y,toToken:b}),q=!1===K.buyWithCryptoEnabled&&!1===K.buyWithFiatEnabled,P=(0,r.useQueryClient)(),_=(0,s.useCallback)(t=>{e.payOptions.onPurchaseSuccess?.({type:"crypto",status:t}),(0,g.V)(P)},[e.payOptions.onPurchaseSuccess,P]),$=(0,s.useCallback)(t=>{e.payOptions.onPurchaseSuccess?.({type:"fiat",status:t}),(0,g.V)(P)},[e.payOptions.onPurchaseSuccess,P]);if("connect-payer-wallet"===h.id)return(0,o.jsx)(D.r,{accountAbstraction:e.connectOptions?.accountAbstraction,appMetadata:e.connectOptions?.appMetadata,chain:e.connectOptions?.chain,chains:e.connectOptions?.chains,client:e.client,connectLocale:e.connectLocale,isEmbed:e.isEmbed,onBack:()=>x(h.backScreen),onSelect:e=>{let t=e.getAccount(),n=e.getChain();e&&t&&n&&u({account:t,chain:n,wallet:e})},hiddenWallets:e.hiddenWallets,recommendedWallets:e.connectOptions?.recommendedWallets,showAllWallets:e.connectOptions?.showAllWallets===void 0||e.connectOptions?.showAllWallets,walletConnect:e.connectOptions?.walletConnect,wallets:e.connectOptions?.wallets?.filter(e=>"inApp"!==e.id)});if("swap-flow"===h.id&&d)return(0,o.jsx)(eY.K,{title:e.title,transactionMode:"transaction"===c.mode,isEmbed:e.isEmbed,client:t,onBack:()=>{x({id:"buy-with-crypto"})},buyWithCryptoQuote:h.quote,payer:d,isFiatFlow:!1,onDone:S,onTryAgain:()=>{x({id:"buy-with-crypto"})},onSuccess:_});if("fiat-flow"===h.id&&d)return(0,o.jsx)(eI,{title:e.title,transactionMode:"transaction"===c.mode,quote:h.quote,onBack:()=>{x({id:"buy-with-fiat"})},client:t,testMode:!1!==e.payOptions.buyWithFiat&&e.payOptions.buyWithFiat?.testMode===!0,theme:"string"==typeof e.theme?e.theme:e.theme.type,openedWindow:h.openedWindow,onDone:S,isEmbed:e.isEmbed,payer:d,onSuccess:$});if("transfer-flow"===h.id&&d&&l){let t=e.payOptions?.paymentInfo?.sellerAddress||l.address;return(0,o.jsx)(e3,{title:e.title,onBack:()=>x({id:"buy-with-crypto"}),payer:d,client:e.client,chain:y,token:b,tokenAmount:m,receiverAddress:t,transactionMode:"transaction"===e.payOptions.mode,payOptions:c,isEmbed:e.isEmbed,onDone:S,onTryAgain:()=>{x({id:"buy-with-crypto"})},onSuccess:_})}if("select-currency"===h.id){let e=()=>x(h.backScreen);return(0,o.jsx)(ej,{onSelect:t=>{e(),M(t)},onBack:e})}if("select-to-token"===h.id){let r=n.map(e=>e.chain),s=()=>x(h.backScreen),l=c?.prefillBuy?.allowEdits;return l?.token===!1?(0,o.jsx)(tr,{chains:r,client:e.client,connectLocale:e.connectLocale,setChain:f,goBack:s}):(0,o.jsx)(I.T,{onBack:s,tokenList:((y?.id?W[y.id]:void 0)||[]).filter(e=>e.address!==i.DG),onTokenSelect:e=>{k(e),s()},chain:y,chainSelection:l?.chain!==!1?{chains:r,select:e=>{f(e)}}:void 0,connectLocale:a,client:t,modalTitle:e.title})}if("select-from-token"===h.id&&A.data&&B){let n=A.data.map(e=>e.chain),r=()=>x(h.backScreen);return!1!==c.buyWithCrypto&&c.buyWithCrypto?.prefillSource?.allowEdits?.token===!1?(0,o.jsx)(tr,{chains:n,client:e.client,connectLocale:e.connectLocale,setChain:R,goBack:r}):(0,o.jsx)(I.T,{onBack:r,tokenList:((z?.id?B[z.id]:void 0)||[]).filter(e=>e.address!==i.DG),onTokenSelect:e=>{O(e),r()},chain:z,chainSelection:!1!==c.buyWithCrypto&&c.buyWithCrypto?.prefillSource?.allowEdits?.chain!==!1?{chains:A.data.map(e=>e.chain),select:e=>R(e)}:void 0,connectLocale:a,client:t,modalTitle:"Pay with"})}return(0,o.jsx)(v.Container,{animate:"fadein",children:(0,o.jsxs)("div",{children:["main"===h.id&&(0,o.jsx)(e6,{title:e.title,payerAccount:d?.account,client:t,onSelectBuyToken:()=>x({id:"select-to-token",backScreen:h}),payOptions:c,setTokenAmount:p,setToChain:f,setToToken:k,setFromChain:R,setFromToken:O,toChain:y,toToken:b,tokenAmount:m,connectOptions:e.connectOptions,setScreen:x,supportedDestinations:n,onBack:e.onBack,theme:e.theme,hasEditedAmount:w,setHasEditedAmount:T,enabledPaymentMethods:K}),("select-payment-method"===h.id||"buy-with-crypto"===h.id||"buy-with-fiat"===h.id)&&d&&(0,o.jsxs)(te,{title:e.title,selectedChain:y,selectedToken:b,tokenAmount:m,client:t,onBack:()=>{K.buyWithCryptoEnabled&&"buy-with-fiat"===h.id?x({id:"select-payment-method"}):"buy-with-crypto"===h.id?x({id:"select-payment-method"}):x({id:"main"})},children:["select-payment-method"===h.id&&(0,o.jsx)(eH,{client:t,mode:c.mode,sourceSupportedTokens:B,hiddenWallets:e.hiddenWallets,payWithFiatEnabled:!1!==e.payOptions.buyWithFiat,toChain:y,toToken:b,tokenAmount:m,onSelect:(e,t,n)=>{let o=e.getAccount();o&&(u({account:o,chain:n,wallet:e}),O(t),R(n),x({id:"buy-with-crypto"}))},onSelectFiat:()=>{x({id:"buy-with-fiat"})},showAllWallets:!!e.connectOptions?.showAllWallets,wallets:e.connectOptions?.wallets,onBack:()=>{},onConnect:()=>{x({id:"connect-payer-wallet",backScreen:{id:"select-payment-method"}})}}),"buy-with-crypto"===h.id&&l&&(0,o.jsx)(tt,{setScreen:x,tokenAmount:C,toChain:y,toToken:b,fromChain:z,fromToken:E,showFromTokenSelector:()=>{x({id:"select-from-token",backScreen:h})},payer:d,client:t,isEmbed:e.isEmbed,onDone:S,payOptions:c,connectLocale:a,connectOptions:e.connectOptions,setPayer:u,activeAccount:l,setTokenAmount:p,setHasEditedAmount:T,disableTokenSelection:!0===q||!1!==c.buyWithCrypto&&c.buyWithCrypto?.prefillSource?.allowEdits?.chain===!1&&c.buyWithCrypto?.prefillSource?.allowEdits?.token===!1}),"buy-with-fiat"===h.id&&(0,o.jsx)(tn,{setScreen:x,tokenAmount:C,toChain:y,toToken:b,selectedCurrency:L,client:t,isEmbed:e.isEmbed,onDone:S,payOptions:c,theme:e.theme,showCurrencySelector:()=>{x({id:"select-currency",backScreen:h})},payer:d,setTokenAmount:p,setHasEditedAmount:T})]})]})})}function e8(e){return(0,o.jsx)("div",{children:(0,o.jsxs)(v.Container,{flex:"row",gap:"sm",center:"y",style:{justifyContent:"space-between"},children:[(0,o.jsxs)(v.Container,{flex:"row",gap:"xs",center:"y",children:[(0,o.jsx)(B.Text,{color:"primaryText","data-testid":"tokenAmount",size:"xl",children:(0,l.Z)(Number(e.tokenAmount),6)}),(0,o.jsxs)(v.Container,{flex:"row",gap:"xxs",center:"y",children:[(0,o.jsx)(z.TokenSymbol,{token:e.selectedToken,chain:e.selectedChain,size:"md",color:"secondaryText"}),(0,o.jsx)(ee.f,{chain:e.selectedChain,client:e.client,size:"sm",token:e.selectedToken})]})]}),(0,o.jsx)(k.R,{chain:e.selectedChain,client:e.client,size:"sm",short:!0})]})})}function e6(e){let{setTokenAmount:t,setToChain:n,setToToken:r,setFromChain:s,setFromToken:i,payerAccount:a,client:c,tokenAmount:l,payOptions:d,toToken:u,toChain:h,supportedDestinations:x,enabledPaymentMethods:m}=e,{buyWithCryptoEnabled:p,buyWithFiatEnabled:y}=m,f=!l;switch(d.mode){case"transaction":return(0,o.jsx)(ey,{supportedDestinations:x,payUiOptions:d,payerAccount:a,connectOptions:e.connectOptions,client:c,onContinue:(o,a,c)=>{t(o),n(a),s(a),i(c),r(c),y&&!p?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-payment-method"})}});case"direct_payment":return(0,o.jsx)(G,{client:c,payUiOptions:d,payerAccount:a,connectOptions:e.connectOptions,supportedDestinations:x,onContinue:(o,a,c)=>{t(o),n(a),s(a),i(c),r(c),y&&!p?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-payment-method"})}});default:return(0,o.jsxs)(v.Container,{p:"lg",children:[(0,o.jsx)(v.ModalHeader,{title:e.title,onBack:e.onBack}),(0,o.jsx)(T.h,{y:"xl"}),(0,o.jsx)(eM,{value:l,onChange:async n=>{e.setHasEditedAmount(!0),t(n)},freezeAmount:d.prefillBuy?.allowEdits?.amount===!1,freezeChainAndToken:d.prefillBuy?.allowEdits?.chain===!1&&d.prefillBuy?.allowEdits?.token===!1,token:u,chain:h,onSelectToken:e.onSelectBuyToken,client:e.client}),(0,o.jsx)(T.h,{y:"xl"}),(0,o.jsx)(v.Container,{flex:"column",gap:"sm",children:a?(0,o.jsx)(W.Button,{variant:"accent",fullWidth:!0,disabled:f,"data-disabled":f,onClick:()=>{y&&!p?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-payment-method"})},children:"Continue"}):(0,o.jsx)("div",{children:(0,o.jsx)(R.ConnectButton,{...e.connectOptions,client:e.client,theme:e.theme,connectButton:{style:{width:"100%"}}})})})]})}}function te(e){return(0,o.jsxs)(v.Container,{children:[(0,o.jsx)(v.Container,{p:"lg",children:(0,o.jsx)(v.ModalHeader,{title:e.title,onBack:e.onBack})}),(0,o.jsxs)(v.Container,{px:"lg",style:{paddingBottom:d.YK.lg},children:[(0,o.jsx)(T.h,{y:"xs"}),(0,o.jsx)(e8,{selectedToken:e.selectedToken,selectedChain:e.selectedChain,tokenAmount:e.tokenAmount,client:e.client}),(0,o.jsx)(T.h,{y:"md"}),(0,o.jsx)(v.Line,{}),(0,o.jsx)(T.h,{y:"lg"}),(0,o.jsx)(B.Text,{size:"sm",children:" Pay with "}),(0,o.jsx)(T.h,{y:"sm"}),e.children]})]})}function tt(e){var t,n;let{setScreen:r,payer:a,client:c,toChain:d,tokenAmount:m,toToken:p,fromChain:y,fromToken:f,payOptions:j,disableTokenSelection:g}=e,C=e.payOptions?.paymentInfo?.sellerAddress||e.activeAccount.address,{drawerRef:b,drawerOverlayRef:k,isOpen:R,setIsOpen:E}=(0,w.useDrawer)(),[I,D]=(0,s.useState)("fees"),O=(0,u.X)({address:a.account.address,chain:y,tokenAddress:(0,F.r)(f)?void 0:f.address,client:c}),L=(0,F.r)(f)?i.DG:f.address.toLowerCase(),M=(0,F.r)(p)?i.DG:p.address.toLowerCase(),K=!!m&&!(y.id===d.id&&L===M),q=(t=K?{fromAddress:a.account.address,toAddress:C,fromChainId:y.id,fromTokenAddress:(0,F.r)(f)?i.DG:f.address,toChainId:d.id,toTokenAddress:(0,F.r)(p)?i.DG:p.address,toAmount:m,client:c,purchaseData:j.purchaseData}:void 0,n={staleTime:3e4,refetchInterval:3e4,gcTime:3e4},(0,h.useQuery)({...n,queryKey:["buyWithCryptoQuote",t],queryFn:()=>{if(!t)throw Error("Swap params are required");return(0,x.c)(t)},enabled:!!t,retry(e,t){if(e>3)return!1;try{let e=t.error;if("MINIMUM_PURCHASE_AMOUNT"===e.code||404===e.statusCode||e.statusCode>=500)return!1}catch{}return!0}})),P=K?q.data?.swapDetails.fromAmount:m,N=!!P&&!!O.data&&Number(O.data.displayValue)<Number(P),_=K&&!q.data||N,$=e.payer.wallet.getChain()?.id!==y.id,H=!q.isLoading&&q.error?function(e){try{if("MINIMUM_PURCHASE_AMOUNT"===e.error.code){let t=e.error.data.minimumAmountEth;return{minAmount:(0,l.Z)(Number(t),6)}}}catch{}return{msg:["Unable to get price quote"]}}(q.error):void 0;return(0,o.jsxs)(v.Container,{flex:"column",gap:"md",animate:"fadein",children:[R&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(w.DrawerOverlay,{ref:k}),(0,o.jsx)(w.Drawer,{ref:b,close:()=>E(!1),children:"fees"===I&&q.data&&(0,o.jsxs)("div",{children:[(0,o.jsx)(B.Text,{size:"lg",color:"primaryText",children:"Fees"}),(0,o.jsx)(T.h,{y:"lg"}),(0,o.jsx)(eq,{quote:q.data})]})})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)(eN,{value:P||"",chain:y,token:f,isLoading:q.isLoading&&!P,client:c,freezeChainAndTokenSelection:g,payerAccount:e.payer.account,swapRequired:K}),K&&(0,o.jsx)(J,{quoteIsLoading:q.isLoading,estimatedSeconds:q.data?.swapDetails.estimated.durationSeconds,onViewFees:function(){q.data&&(E(!0),D("fees"))}}),(0,o.jsx)(T.h,{y:"md"})]}),H&&(0,o.jsxs)("div",{children:[H.minAmount&&(0,o.jsxs)(B.Text,{color:"danger",size:"sm",center:!0,multiline:!0,children:["Minimum amount is ",H.minAmount," ",(0,o.jsx)(z.TokenSymbol,{token:p,chain:d,size:"sm",inline:!0,color:"danger"})]}),H.msg?.map(e=>o.jsx(B.Text,{color:"danger",size:"sm",center:!0,multiline:!0,children:e},e))]}),!H&&N&&(0,o.jsxs)("div",{children:[(0,o.jsx)(B.Text,{color:"danger",size:"sm",center:!0,multiline:!0,children:"Not enough funds."}),(0,o.jsx)(B.Text,{color:"danger",size:"sm",center:!0,multiline:!0,children:"Try a different wallet or token."})]}),H?.minAmount?(0,o.jsx)(W.Button,{variant:"accent",fullWidth:!0,onClick:()=>{e.setTokenAmount(String(H.minAmount)),e.setHasEditedAmount(!0)},children:"Set Minimum"}):!$||q.isLoading||N||q.error?(0,o.jsx)(W.Button,{variant:_?"outline":"accent",fullWidth:!0,"data-disabled":_,disabled:_,onClick:async()=>{_||function(){if("direct_payment"!==e.payOptions.mode&&"fund_wallet"!==e.payOptions.mode||N||K){if("transaction"===e.payOptions.mode&&!N&&!K){a.account.address!==C?r({id:"transfer-flow"}):e.onDone();return}}else r({id:"transfer-flow"});q.data&&r({id:"swap-flow",quote:q.data})}()},gap:"xs",children:q.isLoading?(0,o.jsxs)(o.Fragment,{children:["Getting price quote",(0,o.jsx)(S.Spinner,{size:"sm",color:"accentText"})]}):"Continue"}):(0,o.jsx)(A.b,{variant:"accent",fullWidth:!0,switchChain:async()=>{await e.payer.wallet.switchChain(y)}})]})}function tn(e){var t;let{toToken:n,tokenAmount:r,payer:a,client:d,setScreen:u,toChain:x,showCurrencySelector:m,selectedCurrency:p}=e,y=e.payOptions?.paymentInfo?.sellerAddress||e.payer.account.address,{drawerRef:j,drawerOverlayRef:g,isOpen:C,setIsOpen:b}=(0,w.useDrawer)(),[k,A]=(0,s.useState)("fees"),R=e.payOptions.buyWithFiat,E=(t=!1!==R&&r?{fromCurrencySymbol:p.shorthand,toChainId:x.id,toAddress:y,toTokenAddress:(0,F.r)(n)?i.DG:n.address,toAmount:r,client:d,isTestMode:R?.testMode,purchaseData:e.payOptions.purchaseData,fromAddress:a.account.address,preferredProvider:R?.preferredProvider}:void 0,(0,h.useQuery)({queryKey:["useBuyWithFiatQuote",t],queryFn:async()=>{if(!t)throw Error("No params provided");return f(t)},enabled:!!t,retry(e,t){if(e>3)return!1;try{let e=t.error;if("MINIMUM_PURCHASE_AMOUNT"===e.code||404===e.statusCode||e.statusCode>=500)return!1}catch{}return!0}})),I=!E.data,D=!E.isLoading&&E.error?function(e){try{if("MINIMUM_PURCHASE_AMOUNT"===e.error.code){let t=e.error.data.minimumAmountEth;return{minAmount:(0,l.Z)(Number(t),6)}}}catch{}return{msg:["Unable to get price quote"]}}(E.error):void 0;return(0,o.jsxs)(v.Container,{flex:"column",gap:"md",animate:"fadein",children:[C&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(w.DrawerOverlay,{ref:g}),(0,o.jsx)(w.Drawer,{ref:j,close:()=>b(!1),children:"fees"===k&&E.data&&(0,o.jsxs)("div",{children:[(0,o.jsx)(B.Text,{size:"lg",color:"primaryText",children:"Fees"}),(0,o.jsx)(T.h,{y:"lg"}),(0,o.jsx)(eP,{quote:E.data})]})})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)(en,{isLoading:E.isLoading,value:E.data?.fromCurrencyWithFees.amount,client:d,currency:p,onSelectCurrency:m}),(0,o.jsx)(J,{quoteIsLoading:E.isLoading,estimatedSeconds:E.data?.estimatedDurationSeconds,onViewFees:function(){E.data&&(A("fees"),b(!0))}}),(0,o.jsx)(T.h,{y:"md"})]}),D&&(0,o.jsxs)("div",{children:[D.minAmount&&(0,o.jsxs)(B.Text,{color:"danger",size:"sm",center:!0,multiline:!0,children:["Minimum amount is ",D.minAmount," ",(0,o.jsx)(z.TokenSymbol,{token:n,chain:x,size:"sm",inline:!0,color:"danger"})]}),D.msg?.map(e=>o.jsx(B.Text,{color:"danger",size:"sm",center:!0,multiline:!0,children:e},e))]}),D?.minAmount?(0,o.jsx)(W.Button,{variant:"accent",fullWidth:!0,onClick:()=>{e.setTokenAmount(String(D.minAmount)),e.setHasEditedAmount(!0)},children:"Set Minimum"}):(0,o.jsx)(W.Button,{variant:I?"outline":"accent","data-disabled":I,disabled:I,fullWidth:!0,onClick:function(){if(!E.data)return;let t=c(E.data),n=null;t||(n=eb(E.data.onRampLink,"string"==typeof e.theme?e.theme:e.theme.type),(0,ek.b)({type:"fiat",intentId:E.data.intentId})),u({id:"fiat-flow",quote:E.data,openedWindow:n})},gap:"xs",children:E.isLoading?(0,o.jsxs)(o.Fragment,{children:["Getting price quote",(0,o.jsx)(S.Spinner,{size:"sm",color:"accentText"})]}):"Continue"})]})}function to(e,t,n){let o={},r=!1===t.buyWithFiat,s=!1===t.buyWithCrypto;for(let t of e)o[t.chain.id]=t.tokens.filter(e=>void 0===e.buyWithCryptoEnabled&&void 0===e.buyWithFiatEnabled||!!e.buyWithCryptoEnabled&&!!e.buyWithFiatEnabled||(!!e.buyWithCryptoEnabled||!r)&&(!!e.buyWithFiatEnabled||!s));if(n)for(let e in n){let t=Number(e),r=n[t];r&&(o[t]=r)}return o}function tr(e){return(0,o.jsx)(E.NetworkSelectorContent,{client:e.client,connectLocale:e.connectLocale,showTabs:!1,onBack:e.goBack,chains:e.chains,closeModal:e.goBack,networkSelector:{renderChain:t=>(0,o.jsx)(E.ChainButton,{chain:t.chain,confirming:!1,switchingFailed:!1,onClick:()=>{e.setChain(t.chain),e.goBack()},client:e.client,connectLocale:e.connectLocale})}})}},21685:(e,t,n)=>{n.d(t,{Drawer:()=>f,DrawerOverlay:()=>C,useDrawer:()=>b});var o=n(20698),r=n(95155),s=n(71987),i=n(87365),a=n(12115),c=n(7853),l=n(29524),d=n(39121),u=n(89703),h=n(55970),x=n(16486),m=n(14138),p=n(78749);function y(){let e=(0,o._)(["\n  from {\n    opacity: 0;\n    transform: translateY(100px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n"]);return y=function(){return e},e}let f=(0,a.forwardRef)(function(e,t){return(0,r.jsx)(j,{ref:t,children:(0,r.jsx)(h.X,{children:(0,r.jsxs)(m.Container,{p:"lg",children:[(0,r.jsx)(x.w,{children:(0,r.jsx)(p.IconButton,{type:"button","aria-label":"Close",onClick:e.close,children:(0,r.jsx)(i.MKb,{width:l.RK.md,height:l.RK.md,style:{color:"inherit"}})})}),e.children]})})})}),j=(0,u.jx)(e=>{let t=(0,c.useCustomTheme)();return{zIndex:1e4,borderTopLeftRadius:l.r8.xl,borderTopRightRadius:l.r8.xl,background:t.colors.modalBg,position:"absolute",bottom:0,left:0,right:0,animation:"".concat(g," 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.1)"),borderTop:"1px solid ".concat(t.colors.borderColor)}}),g=(0,s.i7)(y()),C=(0,u.jx)(e=>({backgroundColor:(0,c.useCustomTheme)().colors.modalOverlayBg,zIndex:9999,position:"absolute",inset:0,animation:"".concat(d.I0," 400ms cubic-bezier(0.16, 1, 0.3, 1)")}));function b(){let[e,t]=(0,a.useState)(!1),n=(0,a.useRef)(null),o=(0,a.useRef)(null),r=(0,a.useCallback)(()=>new Promise(e=>{if(n.current){var t;let r={easing:"cubic-bezier(0.175, 0.885, 0.32, 1.1)",fill:"forwards",duration:300},s=n.current.animate([{transform:"translateY(100%)",opacity:0}],r);null===(t=o.current)||void 0===t||t.animate([{opacity:0}],r),s.onfinish=()=>e()}else e()}),[]),s=(0,a.useCallback)(async e=>{e?t(!0):(await r(),t(!1))},[r]);return(0,a.useLayoutEffect)(()=>{if(!e)return;let t=e=>{n.current&&e.target instanceof Node&&!n.current.contains(e.target)&&s(!1)};return requestAnimationFrame(()=>{document.addEventListener("click",t)}),()=>{document.removeEventListener("click",t)}},[e,s]),{drawerRef:n,drawerOverlayRef:o,setIsOpen:s,isOpen:e}}}}]);